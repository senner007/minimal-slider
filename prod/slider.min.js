const Mover=function(listJs,speed,moveEndCallback){var isDormant=!0;var transitionState=0;var prevSpeed;return{get transitionState(){return transitionState},moveMe:function moveMe(distance,setSpeed=speed,callback){if(distance===0)return;distance=Math.round(distance);if(isDormant){isDormant=!1;listJs.addEventListener('transitionend',function moveend(){isDormant=!0;listJs.removeEventListener('transitionend',moveend);moveEndCallback()})}
if(setSpeed!=prevSpeed)listJs.style.transitionDuration=setSpeed;listJs.style.transform="translateX("+(transitionState+distance)+"px)";transitionState+=distance;prevSpeed=setSpeed;if(!callback)return;setTimeout(function(){callback()},20)}}};const Styler=function(list,infiniteScroll,elems){var liOuter,lis=list.children().not('.clone'),listLiJs=list[0].children;listLiJs[0].style.display='none';var origStyle=window.getComputedStyle(listLiJs[0]);var origStyleWidth=origStyle.width;listLiJs[0].style.display='block';var marginBorder=parseInt(origStyle.marginLeft)+parseInt(origStyle.marginRight)+parseInt(origStyle.borderLeftWidth)+parseInt(origStyle.borderRightWidth)
return{get liOuter(){return Math.round(liOuter)},setStyles:function(){var ulParentwidth=Math.round(list.parent().outerWidth(!0));if(origStyleWidth.indexOf('%')!=-1&&ulParentwidth/2>parseInt(lis.css('min-width'))){liOuter=parseInt(origStyleWidth.replace('%','')/100*ulParentwidth)}else{liOuter=parseInt(lis.outerWidth(!0))}(function(index=0){for(let i=0;i<listLiJs.length;i++){if(!listLiJs[i].classList.contains('clone')){listLiJs[i].style.width=liOuter-marginBorder+'px'
listLiJs[i].style.left=(liOuter)*index++ +(ulParentwidth/2-(liOuter/2))+'px'}}})()
if(infiniteScroll){for(let li of list[0].querySelectorAll('.clone')){li.remove()}
var firstClone=listLiJs[0].cloneNode(!0);var secondClone=listLiJs[1].cloneNode(!0);var lastClone=listLiJs[elems-1].cloneNode(!0);var nextLastClone=listLiJs[elems-2].cloneNode(!0);firstClone.style.left=(liOuter)*elems+(ulParentwidth/2-(liOuter/2))+"px"
firstClone.classList.add('clone');secondClone.style.left=(liOuter)*(elems+1)+(ulParentwidth/2-(liOuter/2))+"px"
secondClone.classList.add('clone');lastClone.style.left=ulParentwidth/2-liOuter/2-liOuter+"px"
lastClone.classList.add('clone');nextLastClone.style.left=ulParentwidth/2-liOuter/2-(liOuter*2)+"px"
nextLastClone.classList.add('clone');list.prepend(lastClone).prepend(nextLastClone).append(firstClone).append(secondClone)}}}}
const TouchDrag=function(list,mover,styles){var isTouch=(function is_touch_device(){return(('ontouchstart' in window)||(navigator.MaxTouchPoints>0)||(navigator.msMaxTouchPoints>0))})();var isPointer=(window.PointerEvent);var eStart=isTouch?'touchstart':isPointer?'pointerdown':'mousedown'
var eMove=isTouch?'touchmove':isPointer?'pointermove':'mousemove'
var eEnd=isTouch?'touchend':isPointer?'pointerup':'mouseup'
var lastPageX,startTransition;list.parent().on(eStart,function(e){e.preventDefault();startTransition=mover.transitionState;lastPageX=e.pageX;$(window).on(eMove,onmove).on(eEnd,onup);function onmove(e){e.preventDefault();var newDistance=parseInt(lastPageX-e.pageX);if(Number.isInteger(newDistance)&&newDistance!=0){mover.moveMe(-newDistance,"0s");lastPageX=e.pageX}}
function onup(){$(window).off(eMove,onmove).off(eEnd,onup)
var diff=Math.abs(mover.transitionState-startTransition);if(diff==0)return;if(diff>styles.liOuter/2){if(mover.transitionState>startTransition){mover.jumpMove(+1,styles.liOuter-diff)}else{mover.jumpMove(-1,styles.liOuter-diff)}}else{mover.moveMe(mover.transitionState>startTransition?-diff:diff)}}})}
const Slider=function(o){var state=1,list=o.ul,infiniteScroll=o.infiniteScroll,listJs=list[0],speed=listJs.style.transitionDuration,elems=list.children().length;var mover=Mover(listJs,speed,function(){listJs.dispatchEvent(new CustomEvent('moveEnd',{detail:state}))})
var styles=Styler(list,infiniteScroll,elems);styles.setStyles();mover.jumpMove=function(direction,distance){distance=distance*direction;var jumpPoint=direction<0?elems:1;var jumpDistance=styles.liOuter*elems*-direction;if(state===jumpPoint&&infiniteScroll){state=jumpPoint===1?elems:1;this.moveMe(jumpDistance,"0s",()=>this.moveMe(distance))}else if(state===jumpPoint){this.moveMe(jumpDistance/elems+distance)}
else{this.moveMe(distance);state=direction<0?state+1:state-1}}
if(o.touchDrag)TouchDrag(list,mover,styles);return{moveLeft:function(){mover.jumpMove(1,styles.liOuter)},moveRight:function(){mover.jumpMove(-1,styles.liOuter)},getState:function(){console.log(state)
return state},moveTo:function(num){if(num<1||num>elems||!Number.isInteger(num))return;mover.moveMe(styles.liOuter*(state-num))
state=num},reCalculate:function(){styles.setStyles();this.reset()},reset:function(){mover.moveMe(-mover.transitionState);state=1},_getTransformState:function(){return mover.transitionState}}}